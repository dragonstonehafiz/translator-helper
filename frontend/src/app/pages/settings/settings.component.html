<div class="settings-container">
  <div class="header-container">
    <h1>Settings</h1>
  </div>

  <div class="form-section">
    <app-subsection title="Status">
    
    <div class="status-row">
      <div class="status-box" [class.ready]="openaiReady" [class.not-ready]="!openaiReady">
        <h3 class="component-name">OpenAI API</h3>
        <div class="status-content">
          <div class="status-indicator"></div>
          <span class="status-text">{{ openaiReady ? 'Ready' : 'Not Ready' }}</span>
        </div>
        <div class="status-details" *ngIf="openaiReady && currentOpenaiModel">
          <div>Model: {{ currentOpenaiModel }}</div>
          <div>Temperature: {{ currentTemperature }}</div>
        </div>
      </div>
      
      <div class="status-box" [class.ready]="whisperReady" [class.not-ready]="!whisperReady">
        <h3 class="component-name">Whisper</h3>
        <div class="status-content">
          <div class="status-indicator"></div>
          <span class="status-text">{{ whisperReady ? 'Ready' : 'Not Ready' }}</span>
        </div>
        <div class="status-details" *ngIf="whisperReady && currentWhisperModel">
          <div>Model: {{ currentWhisperModel }}</div>
          <div>Device: {{ currentDevice }}</div>
        </div>
      </div>
    </div>


      <div class="instructions-section" *ngIf="!openaiReady || !whisperReady">
        <div class="instruction-box" *ngIf="!openaiReady">
          Please input OpenAI API key below
        </div>
        <div class="instruction-box" *ngIf="!whisperReady">
          Please initiate the transcription model below
        </div>
      </div>
      <button class="load-button" (click)="checkStatus()">Check Status</button>
    </app-subsection>

    <app-subsection title="Whisper Settings">
        <div class="form-row">
          <div class="form-group">
            <label for="whisperModel">Whisper Model</label>
            <select id="whisperModel" [(ngModel)]="whisperModel" [disabled]="loadingWhisper">
              <option *ngFor="let model of whisperModels" [value]="model">{{ model }}</option>
            </select>
          </div>

          <div class="form-group">
            <label for="device">Device</label>
            <select id="device" [(ngModel)]="device" [disabled]="loadingWhisper">
              <option *ngFor="let dev of devices" [value]="dev.value">{{ dev.label }}</option>
            </select>
          </div>
        </div>
      <button class="load-button" (click)="loadWhisperModel()" [disabled]="loadingWhisper">
        <span *ngIf="!loadingWhisper">Load Whisper Model</span>
        <span *ngIf="loadingWhisper">Loading...</span>
      </button>
    </app-subsection>

    <app-subsection title="OpenAI API Settings">
        <div class="form-group">
          <label for="openaiApiKey">OpenAI API Key</label>
          <input type="password" id="openaiApiKey" [(ngModel)]="openaiApiKey" placeholder="sk-..." [disabled]="loadingGpt">
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="openaiModel">OpenAI Model</label>
            <select id="openaiModel" [(ngModel)]="openaiModel" [disabled]="loadingGpt">
              <option *ngFor="let model of openaiModels" [value]="model">{{ model }}</option>
            </select>
          </div>

          <div class="form-group">
            <label for="temperature">Temperature: {{ temperature }}</label>
            <input type="range" id="temperature" [(ngModel)]="temperature" min="0" max="1.5" step="0.05" [disabled]="loadingGpt">
          </div>
        </div>
      <button class="load-button" (click)="loadGptModel()" [disabled]="loadingGpt || (!openaiApiKey && !openaiReady)">
        <span *ngIf="!loadingGpt">Load GPT Model</span>
        <span *ngIf="loadingGpt">Loading...</span>
      </button>
    </app-subsection>

  </div>
</div>
